# Changelog

æ‰€æœ‰ zigQuant é¡¹ç›®çš„é‡è¦å˜æ›´éƒ½ä¼šè®°å½•åœ¨æ­¤æ–‡ä»¶ä¸­ã€‚

æœ¬é¡¹ç›®éµå¾ª [è¯­ä¹‰åŒ–ç‰ˆæœ¬ 2.0.0](https://semver.org/lang/zh-CN/)ã€‚

---

## [0.2.1] - 2025-12-25

### Fixed
- ğŸ› **Critical**: ä¿®å¤ OrderBook ç¬¦å·å­—ç¬¦ä¸²å†…å­˜ç®¡ç†é—®é¢˜
  - **é—®é¢˜**: `OrderBook.init()` æœªå¤åˆ¶ç¬¦å·å­—ç¬¦ä¸²ï¼Œå¯¼è‡´ WebSocket æ¶ˆæ¯é‡Šæ”¾åå‡ºç°æ‚¬ç©ºæŒ‡é’ˆ
  - **å½±å“**: WebSocket è®¢å•ç°¿æ›´æ–°æ—¶å‘ç”Ÿæ®µé”™è¯¯ (Segmentation Fault)
  - **ä¿®å¤**: OrderBook ç°åœ¨æ‹¥æœ‰ç¬¦å·å­—ç¬¦ä¸²çš„å†…å­˜ï¼ˆä½¿ç”¨ `allocator.dupe()`ï¼‰
  - **ä¿®å¤**: OrderBookManager ä½¿ç”¨ OrderBook æ‹¥æœ‰çš„ç¬¦å·ä½œä¸º HashMap é”®
  - **æ–‡ä»¶**: `src/market/orderbook.zig:81-101,323-343`
  - **è¯¦è§**: [OrderBook Bug è¿½è¸ª](./docs/features/orderbook/bugs.md#bug-001-orderbook-ç¬¦å·å­—ç¬¦ä¸²å†…å­˜ç®¡ç†é—®é¢˜-critical-)

### Added
- âœ¨ WebSocket è®¢å•ç°¿é›†æˆæµ‹è¯• (`tests/integration/websocket_orderbook_test.zig`)
  - éªŒè¯ WebSocket L2 è®¢å•ç°¿å¿«ç…§åº”ç”¨
  - éªŒè¯æœ€ä¼˜ä¹°å–ä»·è¿½è¸ª
  - éªŒè¯å»¶è¿Ÿ < 10ms è¦æ±‚ï¼ˆå®æµ‹ 0.23ms âœ…ï¼‰
  - éªŒè¯æ— å†…å­˜æ³„æ¼
  - **æµ‹è¯•ç»“æœ**: 17 ä¸ªå¿«ç…§ï¼Œæœ€å¤§å»¶è¿Ÿ 0.23msï¼Œæ— å†…å­˜æ³„æ¼
- ğŸ”§ æ„å»ºç³»ç»Ÿæ·»åŠ  `test-ws-orderbook` æ­¥éª¤

### Performance
- âš¡ WebSocket è®¢å•ç°¿æ›´æ–°å»¶è¿Ÿ: 0.23ms (< 10ms è¦æ±‚) âœ…

### Documentation
- ğŸ“ æ›´æ–° OrderBook changelog (v0.2.1)
- ğŸ“ æ›´æ–° OrderBook testing æ–‡æ¡£ï¼ˆæ·»åŠ  WebSocket é›†æˆæµ‹è¯•ï¼‰
- ğŸ“ æ›´æ–° OrderBook bugs.mdï¼ˆè®°å½• BUG-001 ä¿®å¤ï¼‰
- ğŸ“ æ›´æ–° MVP è¿›åº¦æ–‡æ¡£ï¼ˆ95% â†’ 97%ï¼‰

---

## [0.2.0] - 2025-12-25

### Added

#### Core å±‚ (100%)
- âœ¨ **Decimal** - é«˜ç²¾åº¦æ•°å€¼ç±»å‹
  - 18 ä½å°æ•°ç²¾åº¦ï¼ˆæ»¡è¶³é‡‘èäº¤æ˜“éœ€æ±‚ï¼‰
  - åŸºäº i128 æ•´æ•°è¿ç®—ï¼ˆæ— æµ®ç‚¹è¯¯å·®ï¼‰
  - å®Œæ•´ç®—æœ¯è¿ç®—ï¼ˆåŠ å‡ä¹˜é™¤ã€æ¯”è¾ƒã€å–æ¨¡ã€å¹‚è¿ç®—ï¼‰
  - å­—ç¬¦ä¸²è§£æå’Œæ ¼å¼åŒ–
  - 140+ æµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡

- âœ¨ **Time** - æ—¶é—´å¤„ç†ç³»ç»Ÿ
  - é«˜ç²¾åº¦æ—¶é—´æˆ³ï¼ˆæ¯«ç§’çº§ Unix æ—¶é—´æˆ³ï¼‰
  - ISO 8601 æ ¼å¼è§£æå’Œæ ¼å¼åŒ–
  - K çº¿æ—¶é—´å¯¹é½ï¼ˆ1m, 3m, 5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d, 1wï¼‰
  - Duration æ—¶é—´é—´éš”è®¡ç®—

- âœ¨ **Error System** - é”™è¯¯å¤„ç†ç³»ç»Ÿ
  - äº”å¤§é”™è¯¯åˆ†ç±»ï¼ˆNetwork, API, Data, Business, Systemï¼‰
  - ErrorContext é”™è¯¯ä¸Šä¸‹æ–‡
  - WrappedError é”™è¯¯åŒ…è£…
  - é‡è¯•æœºåˆ¶ï¼ˆå›ºå®šé—´éš”å’ŒæŒ‡æ•°é€€é¿ï¼‰

- âœ¨ **Logger** - æ—¥å¿—ç³»ç»Ÿ
  - 6 çº§æ—¥å¿—ï¼ˆTrace, Debug, Info, Warn, Error, Fatalï¼‰
  - å¤šç§ Writerï¼ˆConsole, File, JSON, Customï¼‰
  - ç»“æ„åŒ–å­—æ®µæ”¯æŒ
  - std.log æ¡¥æ¥
  - çº¿ç¨‹å®‰å…¨è®¾è®¡
  - 38+ æµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡

- âœ¨ **Config** - é…ç½®ç®¡ç†ç³»ç»Ÿ
  - JSON é…ç½®æ–‡ä»¶åŠ è½½
  - ç¯å¢ƒå˜é‡è¦†ç›–ï¼ˆZIGQUANT_* å‰ç¼€ï¼‰
  - å¤šäº¤æ˜“æ‰€é…ç½®æ”¯æŒ
  - é…ç½®éªŒè¯å’Œç±»å‹å®‰å…¨
  - æ•æ„Ÿä¿¡æ¯ä¿æŠ¤ï¼ˆsanitizeï¼‰

#### Exchange å±‚ (100%)
- âœ¨ **Exchange Router** - äº¤æ˜“æ‰€æŠ½è±¡å±‚
  - IExchange æ¥å£ï¼ˆVTable æ¨¡å¼ï¼‰
  - ç»Ÿä¸€æ•°æ®ç±»å‹ï¼ˆTradingPair, OrderRequest, Order, Ticker, Orderbook, Position, Balanceï¼‰
  - ExchangeRegistryï¼ˆäº¤æ˜“æ‰€æ³¨å†Œè¡¨ï¼‰
  - SymbolMapperï¼ˆç¬¦å·æ˜ å°„ï¼‰
  - Mock Exchange æ”¯æŒï¼ˆç”¨äºæµ‹è¯•ï¼‰

- âœ¨ **Hyperliquid Connector** - Hyperliquid DEX è¿æ¥å™¨
  - HTTP å®¢æˆ·ç«¯ï¼ˆInfo API + Exchange APIï¼‰
  - WebSocket å®¢æˆ·ç«¯ï¼ˆå®æ—¶æ•°æ®æµï¼‰
  - Ed25519 ç­¾åè®¤è¯
  - é€Ÿç‡é™åˆ¶ï¼ˆ20 req/sï¼‰
  - è®¢é˜…ç®¡ç†å™¨
  - è‡ªåŠ¨é‡è¿æœºåˆ¶
  - ä¸ Exchange Router å®Œå…¨é›†æˆ

#### Market å±‚ (100%)
- âœ¨ **OrderBook** - L2 è®¢å•ç°¿ç®¡ç†
  - L2 è®¢å•ç°¿æ•°æ®ç»“æ„
  - å¿«ç…§åŒæ­¥ï¼ˆ`applySnapshot`ï¼‰
  - å¢é‡æ›´æ–°ï¼ˆ`applyUpdate`ï¼‰
  - æœ€ä¼˜ä»·æ ¼æŸ¥è¯¢ï¼ˆ`getBestBid`, `getBestAsk`ï¼‰
  - ä¸­é—´ä»·å’Œä»·å·®è®¡ç®—ï¼ˆ`getMidPrice`, `getSpread`ï¼‰
  - æ·±åº¦è®¡ç®—ï¼ˆ`getDepth`ï¼‰
  - æ»‘ç‚¹é¢„ä¼°ï¼ˆ`getSlippage`ï¼‰
  - å¤šå¸ç§è®¢å•ç°¿ç®¡ç†å™¨ï¼ˆOrderBookManagerï¼‰
  - çº¿ç¨‹å®‰å…¨ï¼ˆMutex ä¿æŠ¤ï¼‰
  - 9+ æµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡
  - æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼ˆå¿«ç…§ < 500Î¼s, æ›´æ–° < 50Î¼s, æŸ¥è¯¢ < 50nsï¼‰

#### Trading å±‚ (100%)
- âœ¨ **Order System** - è®¢å•ç³»ç»Ÿ
  - è®¢å•ç±»å‹å®šä¹‰ï¼ˆLimit, Market, PostOnly, IOC, ALOï¼‰
  - è®¢å•çŠ¶æ€æšä¸¾ï¼ˆPending, Open, Filled, PartiallyFilled, Cancelled, Rejected, Expiredï¼‰
  - è®¢å•ç”Ÿå‘½å‘¨æœŸç®¡ç†
  - è§¦å‘æ¡ä»¶ï¼ˆTP/SLï¼‰

- âœ¨ **Order Manager** - è®¢å•ç®¡ç†å™¨
  - è®¢å•æäº¤ï¼ˆ`submitOrder`ï¼‰
  - è®¢å•æ’¤é”€ï¼ˆ`cancelOrder`, `cancelAllOrders`ï¼‰
  - è®¢å•æŸ¥è¯¢ï¼ˆ`getOrder`, `getOpenOrders`ï¼‰
  - è®¢å•çŠ¶æ€è¿½è¸ªï¼ˆOrderStoreï¼‰
  - WebSocket äº‹ä»¶å¤„ç†
  - å®Œæ•´æµ‹è¯•è¦†ç›–

- âœ¨ **Position Tracker** - ä»“ä½è¿½è¸ªå™¨
  - ä»“ä½æ•°æ®ç»“æ„
  - ç›ˆäºè®¡ç®—ï¼ˆæœªå®ç°ç›ˆäºå’Œå·²å®ç°ç›ˆäºï¼‰
  - è´¦æˆ·çŠ¶æ€åŒæ­¥ï¼ˆ`syncAccountState`ï¼‰
  - å¤šå¸ç§ä»“ä½ç®¡ç†
  - Position å’Œ Account ç±»å‹å®šä¹‰
  - å®Œæ•´æµ‹è¯•è¦†ç›–

#### CLI å±‚ (100%)
- âœ¨ **CLI Interface** - å‘½ä»¤è¡Œç•Œé¢
  - 11 ä¸ªå‘½ä»¤ï¼ˆticker, orderbook, balance, positions, order, cancel, cancel-all, orders, ç­‰ï¼‰
  - REPL äº¤äº’æ¨¡å¼
  - å½©è‰²è¾“å‡ºå’Œæ ¼å¼åŒ–
  - å¸®åŠ©ç³»ç»Ÿ
  - é”™è¯¯å¤„ç†
  - å®Œæ•´æµ‹è¯•è¦†ç›–

### Tests
- âœ… 173 ä¸ªå•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡ (100%)
- âœ… WebSocket é›†æˆæµ‹è¯•é€šè¿‡
- âœ… Hyperliquid testnet é›†æˆæµ‹è¯•é€šè¿‡
- âœ… æ— å†…å­˜æ³„æ¼
- âœ… æ— ç¼–è¯‘è­¦å‘Š

### Documentation
- ğŸ“š å®Œæ•´çš„æ–‡æ¡£ä½“ç³»ï¼ˆ114+ æ–‡ä»¶ï¼‰
  - 12 ä¸ªåŠŸèƒ½æ¨¡å—æ–‡æ¡£ï¼ˆREADME, API, Implementation, Testing, Changelog, Bugsï¼‰
  - æ¶æ„è®¾è®¡æ–‡æ¡£ï¼ˆARCHITECTURE.mdï¼‰
  - é¡¹ç›®è¿›åº¦æ–‡æ¡£ï¼ˆMVP_V0.2.0_PROGRESS.mdï¼‰
  - æ•…éšœæ’æŸ¥æ–‡æ¡£
  - ç¤ºä¾‹æ•™ç¨‹ï¼ˆ4 ä¸ªå®Œæ•´ç¤ºä¾‹ï¼‰
  - Constitution å¼€å‘è§„èŒƒ
  - Plan Mode æ¶æ„å®ç°è®¡åˆ’

### Performance
- âš¡ Logger çº§åˆ«è¿‡æ»¤: < 1Î¼s (é›¶åˆ†é…)
- âš¡ Time.now(): < 100ns (ç›´æ¥ç³»ç»Ÿè°ƒç”¨)
- âš¡ Config åŠ è½½: < 1ms (å•æ¬¡è§£æ)
- âš¡ Error åˆ›å»º: < 10ns (æ ˆåˆ†é…)
- âš¡ OrderBook å¿«ç…§åº”ç”¨: < 500Î¼s (100 æ¡£)
- âš¡ OrderBook å¢é‡æ›´æ–°: < 50Î¼s
- âš¡ OrderBook æœ€ä¼˜ä»·æ ¼æŸ¥è¯¢: < 50ns (O(1))
- âš¡ API å»¶è¿Ÿ: ~200ms (ç›®æ ‡ < 500ms)
- âš¡ å¯åŠ¨æ—¶é—´: ~150ms (ç›®æ ‡ < 200ms)
- âš¡ å†…å­˜å ç”¨: ~8MB (ç›®æ ‡ < 50MB)

### Fixed
- ğŸ› ä¿®å¤ Logger comptime é”™è¯¯ï¼ˆ7 ä¸ªç¼–è¯‘é”™è¯¯ï¼‰
  - ä½¿ç”¨ `"{s}"` æ ¼å¼å­—ç¬¦ä¸² + å…ƒç»„å‚æ•°
  - æ–‡ä»¶: `src/core/logger.zig:705`

- ğŸ› ä¿®å¤ Mock IExchange.VTable ç¼ºå°‘ `getOpenOrders` å­—æ®µï¼ˆ5 ä¸ªç¼–è¯‘é”™è¯¯ï¼‰
  - æ·»åŠ  mock getOpenOrders å®ç°åˆ°æ‰€æœ‰ mock vtables
  - æ–‡ä»¶: `src/exchange/registry.zig:240`, `src/trading/order_manager.zig:513,596,711`, `src/trading/position_tracker.zig:389`

- ğŸ› ä¿®å¤ StdLogWriter è¾“å‡ºç¼ºå°‘ scope å­—æ®µï¼ˆ2 ä¸ªæµ‹è¯•å¤±è´¥ï¼‰
  - ç›´æ¥åˆ›å»º LogRecord å¹¶åŒ…å« scope å­—æ®µ
  - æ–‡ä»¶: `src/core/logger.zig:705-724`

- ğŸ› ä¿®å¤ Connector æµ‹è¯•é”™è¯¯ç±»å‹ä¸åŒ¹é…ï¼ˆ7 ä¸ªæµ‹è¯•å¤±è´¥ï¼‰
  - ç»Ÿä¸€ä½¿ç”¨ `SignerRequired` é”™è¯¯
  - æ–‡ä»¶: `src/exchange/hyperliquid/connector.zig:889`

- ğŸ› ä¿®å¤ Signer å»¶è¿Ÿåˆå§‹åŒ–æµ‹è¯•é€‚é…ï¼ˆ1 ä¸ªæµ‹è¯•å¤±è´¥ï¼‰
  - ä¿®æ”¹æµ‹è¯•ä»¥åŒ¹é…å»¶è¿Ÿåˆå§‹åŒ–è®¾è®¡
  - æ–‡ä»¶: `src/exchange/hyperliquid/connector.zig:1314-1324`

---

## [0.1.0] - 2025-12-23

### Added
- ğŸ‰ é¡¹ç›®åˆå§‹åŒ–
- âœ¨ åŸºç¡€ç›®å½•ç»“æ„
- âœ¨ æ„å»ºç³»ç»Ÿï¼ˆbuild.zigï¼‰
- ğŸ“š åˆå§‹æ–‡æ¡£æ¡†æ¶

---

## ç‰ˆæœ¬è§„èŒƒ

éµå¾ª [è¯­ä¹‰åŒ–ç‰ˆæœ¬ 2.0.0](https://semver.org/lang/zh-CN/)ï¼š

- **MAJOR**: ä¸å…¼å®¹çš„ API å˜æ›´
- **MINOR**: å‘åå…¼å®¹çš„åŠŸèƒ½æ–°å¢
- **PATCH**: å‘åå…¼å®¹çš„ Bug ä¿®å¤

### æ ‡ç­¾è¯´æ˜

- âœ¨ `Added`: æ–°å¢åŠŸèƒ½
- ğŸ”§ `Changed`: åŠŸèƒ½å˜æ›´
- ğŸ› `Fixed`: Bug ä¿®å¤
- âš¡ `Performance`: æ€§èƒ½ä¼˜åŒ–
- ğŸ“ `Documentation`: æ–‡æ¡£æ›´æ–°
- ğŸ—‘ï¸ `Deprecated`: å³å°†åºŸå¼ƒçš„åŠŸèƒ½
- ğŸ”¥ `Removed`: ç§»é™¤çš„åŠŸèƒ½
- ğŸ”’ `Security`: å®‰å…¨ä¿®å¤

---

## MVP v0.2.0 åŠŸèƒ½æ¸…å•

- âœ… Hyperliquid DEX å®Œæ•´é›†æˆ
- âœ… å®æ—¶å¸‚åœºæ•°æ® (HTTP + WebSocket)
- âœ… Orderbook ç®¡ç†å’Œæ›´æ–°
- âœ… è®¢å•ç®¡ç† (ä¸‹å•ã€æ’¤å•ã€æŸ¥è¯¢)
- âœ… ä»“ä½è·Ÿè¸ªå’Œ PnL è®¡ç®—
- âœ… CLI ç•Œé¢ (11 ä¸ªå‘½ä»¤ + REPL)
- âœ… é…ç½®æ–‡ä»¶ç³»ç»Ÿ
- âœ… æ—¥å¿—ç³»ç»Ÿ
- âœ… å®Œæ•´æ–‡æ¡£ (114+ æ–‡ä»¶)
- âœ… WebSocket é›†æˆæµ‹è¯•
- âœ… 173 ä¸ªå•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡

---

## ä¸‹ä¸€ç‰ˆæœ¬è®¡åˆ’

### v0.3.0 - ç­–ç•¥æ¡†æ¶ (è®¡åˆ’ä¸­)
- [ ] ç­–ç•¥æ¥å£å®šä¹‰
- [ ] ä¿¡å·ç”Ÿæˆå™¨
- [ ] é£é™©ç®¡ç†æ¨¡å—
- [ ] å›æµ‹æ¡†æ¶åŸºç¡€

### v0.4.0 - å›æµ‹å¼•æ“ (è®¡åˆ’ä¸­)
- [ ] å†å²æ•°æ®ç®¡ç†
- [ ] å›æµ‹æ‰§è¡Œå¼•æ“
- [ ] æ€§èƒ½åˆ†æå·¥å…·
- [ ] ç­–ç•¥ä¼˜åŒ–å™¨

### v1.0.0 - ç”Ÿäº§å°±ç»ª (æœªæ¥)
- [ ] å®Œæ•´çš„é‡åŒ–äº¤æ˜“ç³»ç»Ÿ
- [ ] å¤šäº¤æ˜“æ‰€æ”¯æŒ
- [ ] Web ç®¡ç†ç•Œé¢
- [ ] ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ

---

*æ›´æ–°æ—¶é—´: 2025-12-25*
*å½“å‰ç‰ˆæœ¬: v0.2.1*
