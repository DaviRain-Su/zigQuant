# zigQuant v0.6.0 Release Notes

**发布日期**: 2025-12-27
**版本**: v0.6.0
**代号**: 混合计算模式

---

## 概述

v0.6.0 是 zigQuant 的重要里程碑版本，实现了向量化回测与事件驱动实盘的混合计算模式。本版本带来了 **12.6M bars/s** 的超高性能回测引擎、完整的交易所适配器、Paper Trading 模拟交易系统以及策略热重载功能。

---

## 核心亮点

### 向量化回测引擎 (12.6M bars/s)

- **SIMD 优化**: 利用 Zig 的 `@Vector` 类型进行批量计算
- **性能突破**: 12,600,000 bars/s (目标 100,000 bars/s，超越 126 倍)
- **内存映射**: 支持大文件 mmap 加载
- **批量处理**: 指标计算和信号生成向量化

```zig
const VectorizedBacktester = @import("zigQuant").VectorizedBacktester;

var backtester = try VectorizedBacktester.init(allocator);
defer backtester.deinit();

// 12.6M bars/s 回测性能
const results = try backtester.run(candles, &strategy);
```

### Hyperliquid 交易所适配器

**HyperliquidDataProvider** - 实现 IDataProvider 接口:
- WebSocket 实时数据流
- Quote/Candle/OrderBook 订阅
- MessageBus 事件发布
- Cache 自动更新

**HyperliquidExecutionClient** - 实现 IExecutionClient 接口:
- 订单提交/取消/查询
- 仓位和余额查询
- 订单状态同步
- 完整的 VTable 实现

```zig
// 创建数据提供者
var data_provider = HyperliquidDataProvider.init(allocator);
const provider = data_provider.asDataProvider();

// 创建执行客户端
var execution_client = HyperliquidExecutionClient.init(allocator);
const client = execution_client.asExecutionClient();
```

### Paper Trading 模拟交易

完整的模拟交易系统，使用真实市场数据但不实际执行订单:

- **PaperTradingEngine**: 主调度引擎
- **SimulatedAccount**: 虚拟账户管理
- **SimulatedExecutor**: 模拟订单执行
- **统计分析**: 胜率、盈亏比、最大回撤

```zig
var engine = PaperTradingEngine.init(allocator, .{
    .initial_balance = Decimal.fromInt(10000),
    .commission_rate = Decimal.fromFloat(0.0005),
    .slippage = Decimal.fromFloat(0.0001),
});
defer engine.deinit();
engine.connectComponents();

engine.start();
_ = try engine.buy("ETH", Decimal.fromFloat(0.1), Decimal.fromInt(2000));
engine.stop();  // 打印统计摘要
```

### 策略热重载

运行时参数更新，无需重启交易引擎:

- **HotReloadManager**: 配置文件监控
- **ParamValidator**: 参数验证
- **SafeReloadScheduler**: tick 间隙安全重载
- **JSON 配置支持**: 标准化配置格式

```json
{
  "strategy": "dual_ma",
  "version": 2,
  "params": {
    "fast_period": { "value": 10, "min": 2, "max": 50 },
    "slow_period": { "value": 30, "min": 10, "max": 200 }
  },
  "risk": {
    "stop_loss_pct": 0.02,
    "take_profit_pct": 0.05
  }
}
```

---

## 性能指标

| 指标 | 目标 | 实际 | 状态 |
|------|------|------|------|
| 向量化回测速度 | > 100,000 bars/s | 12,600,000 bars/s | ✅ 超越 126x |
| 实盘数据延迟 | < 10ms | 0.23ms | ✅ |
| 订单执行延迟 | < 100ms | ~50ms | ✅ |
| 内存占用 | < 100MB | ~8MB | ✅ |

---

## 新增模块

### 向量化回测 (`src/backtest/vectorized/`)
- `mod.zig` - 模块导出
- `backtester.zig` - 核心回测引擎
- `indicators.zig` - SIMD 指标计算
- `signals.zig` - 批量信号生成

### 交易所适配器 (`src/adapters/`)
- `mod.zig` - 模块导出
- `data_provider.zig` - HyperliquidDataProvider
- `execution_client.zig` - HyperliquidExecutionClient

### 交易模块 (`src/trading/`)
- `paper_trading.zig` - PaperTradingEngine
- `simulated_account.zig` - SimulatedAccount
- `simulated_executor.zig` - SimulatedExecutor
- `hot_reload.zig` - HotReloadManager
- `mod.zig` - 模块导出

---

## 代码统计

| 模块 | 行数 | 描述 |
|------|------|------|
| `backtest/vectorized/` | ~1,500 | 向量化回测 |
| `adapters/` | ~1,200 | 交易所适配器 |
| `trading/paper_trading.zig` | ~420 | Paper Trading |
| `trading/simulated_*.zig` | ~700 | 模拟账户和执行器 |
| `trading/hot_reload.zig` | ~600 | 热重载管理 |
| **总计** | **~4,400** | **v0.6.0 新增代码** |

---

## 测试覆盖

- **单元测试**: 558 个 (从 502 增长)
- **所有测试通过**: ✅
- **内存泄漏检测**: ✅ 零泄漏

---

## Stories 完成清单

| Story | 名称 | 状态 |
|-------|------|------|
| 028 | 向量化回测引擎 | ✅ 完成 |
| 029 | HyperliquidDataProvider | ✅ 完成 |
| 030 | HyperliquidExecutionClient | ✅ 完成 |
| 031 | Paper Trading | ✅ 完成 |
| 032 | 策略热重载 | ✅ 完成 |

---

## 升级指南

### 从 v0.5.0 升级

v0.6.0 完全向后兼容 v0.5.0。新增功能可选使用。

### 新功能使用

```zig
const zigQuant = @import("zigQuant");

// 向量化回测
const VectorizedBacktester = zigQuant.VectorizedBacktester;

// Paper Trading
const PaperTradingEngine = zigQuant.PaperTradingEngine;

// 热重载
const HotReloadManager = zigQuant.HotReloadManager;
```

---

## 下一版本预告

### v0.7.0 - 做市优化

- Clock-Driven 做市策略
- 订单前置追踪优化
- 做市策略模板
- 库存管理

---

## 致谢

感谢所有参与 v0.6.0 开发的贡献者。

---

**发布日期**: 2025-12-27
**完整文档**: [docs/stories/v0.6.0/OVERVIEW.md](../stories/v0.6.0/OVERVIEW.md)
