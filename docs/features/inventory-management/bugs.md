# Inventory Management Bug 追踪

> 库存管理模块的已知问题和潜在风险

**版本**: v0.7.0
**状态**: 📋 待开发
**最后更新**: 2025-12-27

---

## 当前状态

```
开放 Bug: 0
已修复: 0
待验证: 0
```

---

## 潜在问题

开发前识别的潜在风险点:

### P-001: 偏斜计算溢出

**风险等级**: 中

**描述**: 当库存超过 max_inventory 时，归一化值可能超过预期范围。

**预防措施**:
```zig
// 确保偏斜值在有效范围内
const normalized = std.math.clamp(
    current / max,
    -1.0,
    1.0
);
```

### P-002: 浮点精度问题

**风险等级**: 低

**描述**: skew_factor 等浮点参数可能因精度问题产生累积误差。

**预防措施**:
- 使用 Decimal 进行金额计算
- 浮点数只用于比例和系数
- 定期验证报价合理性

### P-003: 再平衡死循环

**风险等级**: 中

**描述**: 如果再平衡订单执行失败，可能陷入持续尝试再平衡的状态。

**预防措施**:
- 添加再平衡冷却时间
- 限制最大再平衡尝试次数
- 记录再平衡失败日志

### P-004: 紧急状态恢复

**风险等级**: 中

**描述**: 进入紧急状态后的恢复机制不明确。

**预防措施**:
- 定义明确的恢复条件
- 需要手动确认才能退出紧急状态
- 记录紧急事件详情

### P-005: 分段偏斜边界

**风险等级**: 低

**描述**: tiered 模式下，在阈值边界可能产生跳跃。

**预防措施**:
- 考虑使用平滑过渡
- 或明确文档说明阶梯行为

---

## Bug 模板

```markdown
### BUG-XXX: [简短描述]

**状态**: 🔴 开放 | 🟡 进行中 | 🟢 已修复
**优先级**: P0 | P1 | P2
**发现版本**: v0.7.0
**修复版本**: -

**描述**:
[详细描述问题]

**复现步骤**:
1. 步骤 1
2. 步骤 2
3. 预期结果 vs 实际结果

**根因分析**:
[分析原因]

**修复方案**:
[描述修复]

**测试验证**:
- [ ] 单元测试
- [ ] 集成测试
- [ ] 手动验证

**相关代码**:
- `src/market_making/inventory.zig:XXX`
```

---

## 修复历史

暂无修复记录。

---

*Last updated: 2025-12-27*
